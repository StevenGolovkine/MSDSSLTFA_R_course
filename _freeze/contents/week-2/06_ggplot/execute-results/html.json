{
  "hash": "d0ba5840ef8128b8684f173f1d9d1ec1",
  "result": {
    "markdown": "---\ntitle: \"Data visualisation with ggplot2\"\nengine: knitr\n---\n\n\n\n\nWe have seen that R's base graphics system can create plots or graphs, with the ability to control almost every aspect of them. The `ggplot2` package is part of the `tidyverse` and is used to create complex and sophisticated visualisations of large data sets. The package uses the *grammar of graphics* (gg), a coherent system for building graphics. `ggplot2` creates graphics iteratively over several layers. You can read more about it [here](https://ggplot2-book.org/getting-started.html).\n\n## Creating a ggplot\n\nThe `ggplot()` function is used to create a ggplot. The function works on data frames rather than vectors like in base R. Once a basic ggplot has been created, the plot can be enhanced by adding more layers to it.\n\nA ggplot has three key components:  \n\n1. **Data** - ggplot() requires a data frame to be supplied in tidy format.  \n2. **Mapping** - aesthetic mapping(s) between variables in the data and visual properties.  \n3. **Layer(s)** - at least one layer describing how to render (i.e. plot) each observation. Usually created using `geom` functions.\n\n\n## Scatterplot bill length vs flipper length\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n    data = penguins, # data\n    aes(x = bill_length_mm, y = flipper_length_mm)  # aesthetic\n) + \n  geom_point()  # layer\n```\n\n::: {.cell-output-display}\n![](06_ggplot_files/figure-html/plot1-1.png){width=672}\n:::\n:::\n\n\nThis produces a scatterplot defined by:\n\n1. **Data:** penguins\n2. **Mapping:** bill length mapped to x axis, flipper length to y axis\n3. **Layer:** points\n\n## The data\n\nThe first argument specified is the data frame to be used in the plotting process. Here this is the penguins data frame. Using `ggplot(data = penguins)` will create an empty plot (try it!). We can then add layers to that plot. By default these layers will use the data specified in the `ggplot()` command, however we can change this behaviour if needed.\n\n## Mappings and aesthetics\n\nThe `aes()` command is a mapping from the columns in our data to aesthetics which are the visual properties of our plot.  In most scenarios this will map columns to the x and/or y-axes. We can also map columns of our data to colour, shape or size of the plotted points, for example.\n\n## Geometries\n\nLayers are added using *geometries* or `geom` functions and the `+` operator. The `geom`s automatically inherit the default aesthetic mappings specified in the `ggplot()` command, however this behaviour can be modified. \n\nExamples include:\n\n* `geom_point()` - adds a layer of points to the plot\n* `geom_lines()` - adds a layer of lines to the plot\n* `geom_histogram()` - adds a histogram to the plot\n* `geom_boxplot()` - adds a boxplot to the plot\n* `geom_smooth()` - adds a smoother to the plot\n\n\n### Boxplot of bill length\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n    data = penguins,  # data\n    aes(y = bill_length_mm)  # aesthetic\n) + \n    geom_boxplot()  # layer\n```\n\n::: {.cell-output-display}\n![](06_ggplot_files/figure-html/plot2-1.png){width=672}\n:::\n:::\n\n\nThis produces a boxplot defined by:\n\n1. **Data:** penguins\n2. **Mapping:** bill length mapped to y axis\n3. **Layer:** boxplot\n\n### Scatterplot smooth bill vs flipper length\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n    data = penguins,  # data\n    aes(x = bill_length_mm, y = flipper_length_mm)  # aesthetic\n) + \n    geom_point() +  # layer 1\n    geom_smooth()  # << # layer 2 \n```\n\n::: {.cell-output-display}\n![](06_ggplot_files/figure-html/plot3-1.png){width=672}\n:::\n:::\n\n\n\n## Colour, size, shape attributes\n\nThe `aes()` argument can also map columns in the data frame to other aesthetics like colour, size and shape. To change the colour, shape and size of the points plotted in the scatterplot of bill length versus flipper length by species:\n\n* `aes(x = bill_length_mm, y = flipper_length_mm, colour = species)`\n* `aes(x = bill_length_mm, y = flipper_length_mm, shape = species)`\n* `aes(x = bill_length_mm, y = flipper_length_mm, size = species)`\n    \nggplot2 converts the data (e.g. Gentoo, Adelie and Chinstrap) into aesthetics (e.g., ‘red’, ‘yellow’, ‘green’) with a scale. \n\n## Change colour\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n    data = penguins, \n    aes(\n        x = bill_length_mm, \n        y = flipper_length_mm,\n        colour = species  # <<\n    )\n) + \n    geom_point() \n```\n\n::: {.cell-output-display}\n![](06_ggplot_files/figure-html/plot4-1.png){width=672}\n:::\n:::\n\n\n## Change shape\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n    data = penguins, \n    aes(\n        x = bill_length_mm, \n        y = flipper_length_mm,\n        shape = species  # <<\n    )\n) +\n    geom_point() \n```\n\n::: {.cell-output-display}\n![](06_ggplot_files/figure-html/plot5-1.png){width=672}\n:::\n:::\n\n\n## Change size\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n    data = penguins, \n    aes(\n        x = bill_length_mm, \n        y = flipper_length_mm,\n        size = species  # <<\n    )\n) +\n    geom_point() \n```\n\n::: {.cell-output-display}\n![](06_ggplot_files/figure-html/plot6-1.png){width=672}\n:::\n:::\n\n\n## Change colour, shape and size\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n    data = penguins, \n    aes(\n        x = bill_length_mm, \n        y = flipper_length_mm,\n        colour = species,  # <<\n        shape = species,  # <<\n        size = species  # <<\n    )\n) +  \n    geom_point() \n```\n\n::: {.cell-output-display}\n![](06_ggplot_files/figure-html/plot7-1.png){width=672}\n:::\n:::\n\n\n## Labels and titles\n\nAxis labels can be added separately using the `+` operator and `xlab()` and/or `ylab()`. A plot title can be added using the `+` operator and `ggtitle()`. Using the `+` operator and the `labs()` function can add axis labels, plot title and plot sub-titles all in one step.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n    data = penguins, \n    aes(\n        x = bill_length_mm, \n        y = flipper_length_mm,\n        colour = species\n    )\n) +  \n    geom_point() +\n    xlab(\"Bill length (mm)\") +  # <<\n    ylab(\"Flipper length (mm)\") +  # <<\n    ggtitle(\"Penguin data\")  # <<\n```\n\n::: {.cell-output-display}\n![](06_ggplot_files/figure-html/plot8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n    data = penguins, \n    aes(\n        x = bill_length_mm, \n        y = flipper_length_mm,\n        colour = species\n    )\n) + \n    geom_point() +\n    labs(\n        x = \"Bill length (mm)\",  # <<\n        y = \"Flipper length (mm)\",  # <<\n        title = \"Penguin data\",  # <<\n        subtitle = \"Scatterplot by species\"  # <<\n    )\n```\n\n::: {.cell-output-display}\n![](06_ggplot_files/figure-html/plot9-1.png){width=672}\n:::\n:::\n\n\n## Themes\n\nThemes allow you control over the non-data elements of your plot. These include the font, ticks, panel strips and background. The default theme in `ggplot()` is the grey theme (please do not use it...). Other themes that you can use are given [here](https://ggplot2-book.org/polishing.html)\n\n\n### theme_bw()\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n    data = penguins, \n    aes(\n        x = bill_length_mm, \n        y = flipper_length_mm,\n        colour = species\n    )\n) + \n    geom_point() +\n    labs(\n        x = \"Bill length (mm)\",  \n        y = \"Flipper length (mm)\",\n        title = \"Penguin data\",  \n        subtitle = \"Scatterplot by species\"\n    ) + \n    theme_bw()  # <<\n```\n\n::: {.cell-output-display}\n![](06_ggplot_files/figure-html/plot10-1.png){width=672}\n:::\n:::\n\n\n\n## What else can I do?\n\nLots! \n\nThe `ggplot2` package is extremely powerful and there are great resources to be found such as the [coding club](https://ourcodingclub.github.io/tutorials/dataviz-beautification-synthesis/), [blog posts](https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/) and [short talks](https://yegrug.github.io/data-vis-practice/ggplot2-intro_2021-12-16.html#1) to get you started. Great advice is to find code for plots you like and then modify it for your needs!\n\n\n## Additional resources\n\n\n<br><br>\n\n::: {style=\"font-size: 0.875em;\"}\nBack to [week 02](/weeks/week-2.qmd) ⏎\n:::",
    "supporting": [
      "06_ggplot_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}