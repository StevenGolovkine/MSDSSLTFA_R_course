{
  "hash": "fd04e56f62427dafae57ac99f1aae101",
  "result": {
    "markdown": "---\ntitle: \"Sampling from statistical distributions\"\nengine: knitr\n---\n\n\n\n\n<br>\nSampling from statistical distributions is the process of generating random numbers following specific distribution patterns, such as normal (Gausian), exponential or Poisson distributions. We simulate from distribution to (try to) replicate real-world data scenarios. R provides lots of functions to do so.\n\n## Distributions the `stats` package in R\n\nSome of the classical distributions have already been implemented in R, and you can easily sampled from them. All functions are based on the same schema:\n\n* `dxxx`: the density/mass function;\n* `pxxx`: the cumulative distribution function;\n* `qxxx`: the quantile function;\n* `rxxx`: the pseudo-random number generator.\n\nThe `xxx` has to be replaced by the name of the distribution, e.g., `norm` for a normal distribution, `unif` for a uniform distribution or `pois` for a Poisson distribution.\n\n::: {.callout-note appearance=\"simple\"}\n\n## Example: a sample from $\\mathcal{N}(0, 1)$.\n\nHere, we generate a sample of $5$ observations following a standard normal distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nrnorm(5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```{.outputcode}\n[1]  1.3709584 -0.5646982  0.3631284  0.6328626  0.4042683\n```\n:::\n:::\n\n\n:::\n\n::: {.callout-note appearance=\"simple\"}\n\n## Example: a sample from $\\mathcal{B}(10, 0.5)$.\n\nWe generate a sample of $5$ observations following a binomial distribution with parameters $n = 10$ and $p = 0.5$. This can be interpreted as the number of successes in $n$ trials, the probability of success being $p$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nrbinom(5, 10, 0.5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```{.outputcode}\n[1] 7 7 4 7 6\n```\n:::\n:::\n\n\n:::\n\n::: {.callout-note appearance=\"simple\"}\n\n## Example: the probability density function of $\\mathcal{B}(2, 2)$.\n\nUsing a generated sample with a Beta $\\mathcal{B}(2, 2)$ distribution, we estimate the probability density function and compare to the truth.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nsample <- rbeta(1000, 2, 2)  # Generate B(2, 2)\n\ndensity_estim <- density(sample, from = 0, to = 1)\ndensity_true <- dbeta(density_estim$x, 2, 2)\n\ndensity_df <- tibble(\n  x = density_estim$x,\n  True = density_true,\n  Estimation = density_estim$y\n) |> \n  pivot_longer(cols = c(True, Estimation))\n\nggplot(density_df) +\n  geom_line(aes(x = x, y = value, color = name)) +\n  xlab(\"\") +\n  ylab(\"Density\") +\n  theme_bw() +\n  theme(\n    legend.title = element_blank(),\n    legend.position = c(0.9, 0.9)\n  )\n```\n\n::: {.cell-output-display}\n![](02_distributions_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n:::\n\n::: {.callout-note appearance=\"simple\"}\n\n## Example: the cumulative density function of $\\mathcal{P}(5)$\n\nUsing the generated sample with a Poisson $\\mathcal{P}(5)$ distribution, we estimate the cumulative distribution function and compare to the truth.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nsample <- rpois(1000, 5)  # Generate P(5)\n\nx = seq(-1, 20, by = 0.1)\necdf_estim <- ecdf(sample)(x)\necdf_true <- ppois(x, 5)\n\necdf_df <- tibble(\n  x = x,\n  True = ecdf_true,\n  Estimation = ecdf_estim\n) |> \n  pivot_longer(cols = c(True, Estimation))\n\nggplot(ecdf_df) +\n  geom_step(\n    aes(x = x, y = value, color = name),\n    direction = \"hv\"\n  ) +\n  geom_point(\n    aes(x = x, y = value, color = name),\n    data = filter(ecdf_df, x %in% seq(-1, 20, by = 1))\n  ) +\n  xlab(\"\") +\n  ylab(\"ECDF\") +\n  theme_bw() +\n  theme(\n    legend.title = element_blank(),\n    legend.position = c(0.9, 0.1)\n  )\n```\n\n::: {.cell-output-display}\n![](02_distributions_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n:::\n\n# Additional resources\n\n* R Documentation: [Distributions](https://cran.r-project.org/web/views/Distributions.html)\n\n<br><br>\n\n::: {style=\"font-size: 0.875em;\"}\nBack to [week 08](/weeks/week-8.qmd) ‚èé\n:::",
    "supporting": [
      "02_distributions_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}