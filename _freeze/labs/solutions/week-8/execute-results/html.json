{
  "hash": "94f82432d839359f4553404a2e646f2d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Possible solution for lab - Simulation\"\noutput:\n  html_document: default\n  pdf_document: default\ndate: \"2023-10-12\"\n---\n\n\n\n\n\n## The inverse transform method\n\n1. Let $f : x \\in (0, 1/2) \\to 1/\\sqrt{2x}$ be a probability density function of a random variable $X$. Generate using the inverse transform method a sample of size 100 of $X$.\n\nLet $F$ be the associated cdf of $f$. Then\n$$F(t) = \\int_{-\\infty}^{t}f(x)dx = \\left\\{\n    \\begin{array}{r c l}\n        1 &\\text{if}& x \\geq 1/2\\\\\n        \\int_{0}^{t}f(x)dx &\\text{if}& x \\in ]0,1/2[\\\\\n        0 &\\text{if}& x \\leq 0\n    \\end{array}\\right. = \\left\\{\n    \\begin{array}{r c l}\n        1 &\\text{if}& x \\geq 1/2\\\\\n        \\sqrt{2t} &\\text{if}& x \\in ]0,1/2[\\\\\n        0 &if& x \\leq 0\n    \\end{array}\\right..$$\n    \n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nn <- 100\nu <- runif(n, 0, 1)\nx <- u^2/2\n\n# Compare the empirical cdf of x\nplot(ecdf(x), xlim = c(0,1/2))\ncurve(sqrt(x*2), col = 'red', add = TRUE)\n```\n\n::: {.cell-output-display}\n![](week-8_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n                                                                         \n2. Generate a sample from the cumulative density function $F(x)=1- \\exp(-\\exp((x-\\mu)/\\sigma))$. Compare the empirical cumulative density function of the generated sample with $F$.\n\nThe inverse if the cdf is given by:\n$$F^{-1}(u) = \\sigma\\ln(-\\ln(1-u)) + \\mu.$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(0)\nn <- 100\nmu <- 5\nsigma <- 0.2\nu <- runif(n, 0, 1)\nx <- sigma * log(-log(1 - u)) + mu\n\n# Compare the empirical cdf of x\nplot(ecdf(x))\ncurve(1 - exp(-exp((x - mu)/sigma)), col = 'red', add = TRUE)\n```\n\n::: {.cell-output-display}\n![](week-8_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n## Using R functions\n\n3. Plot the probability density function of a Student distribution with varying parameters. Generate a sample of data with a $t(5)$ distribution, compute the empirical cumulative density function and compare it to the true one.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\ncurve(dt(x, 1), from = -10, to = 10, ylim = c(0, 0.5))\nfor (df in seq(2, 16, by = 2)) {\n    curve(dt(x, df), from = -10, to = 10, add = TRUE, col = df)\n}\n```\n\n::: {.cell-output-display}\n![](week-8_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\n\nn <- 100\nsample <- rt(n, 5)\n\nplot(ecdf(sample))\ncurve(pt(x, 5), col = 'red', add = TRUE)\n```\n\n::: {.cell-output-display}\n![](week-8_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n## Composition method\n\nLet $X_1 \\sim \\Gamma(2,2)$ and $X_2 \\sim \\Gamma(2,4)$ be independent.\nThe probability density function of $X_i$ $(i=1,2)$ is denoted by $f_i$.\n\n4. Generate a sample of size $100$ from $Y_1 = (X_1+X_2)/2$.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(0)\nn <- 100\nx1 <- rgamma(n, 2, 2)\nx2 <- rgamma(n, 2, 4)\n\ny1 <- (x1 + x2)/2\nplot(density(y1), xlab = '', ylab = '', main = '')\n```\n\n::: {.cell-output-display}\n![](week-8_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n5. Let $Y_2$ be a random variable of pdf $\\frac{1}{2} f_1 + \\frac{1}{2} f_2.$ Generate a sample of size 100 from $Y_2.$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(0)\nn <- 100\n\nu <- runif(n, 0, 1)\ny <- 1*(u < 0.5) + 2*(u >= 0.5)\n\ny2 <- (y == 1)*rgamma(n, 2, 2) + (y == 2)*rgamma(n, 2, 4)\n\ncurve(0.5 * dgamma(x, 2, 2) + 0.5 * dgamma(x, 2, 4), xlim = c(0,5), ylab = \"\")\ncurve(0.5 * dgamma(x, 2, 2), add = TRUE, col = 'red')\ncurve(0.5 * dgamma(x, 2, 4), add = TRUE, col = 'green')\n\nrug(y2[y == 1], col = 'red')\nrug(y2[y == 2], col = 'green')\n```\n\n::: {.cell-output-display}\n![](week-8_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n6. Compare the sampling distribution of $Y_1$ and $Y_2.$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqqplot(y1, y2)\nabline(0, 1, col = 'red')\n```\n\n::: {.cell-output-display}\n![](week-8_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n7. Generate some data using this model:\n\n$$ Y = \\beta_0 + \\beta_1 x^2 + \\beta_2 \\log(x) + \\epsilon,$$\n\nwhere $\\epsilon = \\mathcal{N}(0, 1)$. Fix $\\beta_0 = 4$, $\\beta_1 = 0.3$ and $\\beta_2 = 2$.\nGenerate $X \\sim \\mathcal{U}(1, 5)$. Plot the data. Fit a linear and try to retrieve the coefficients.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nn <- 100\nx <- runif(n, 1, 5)\neps <- rnorm(n, 0, 1)\n\ny <- 4 + 0.3 * x^2 + 2 * log(x) + eps\n\nplot(x, y)\n```\n\n::: {.cell-output-display}\n![](week-8_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(y ~ I(x^2) + log(x)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ I(x^2) + log(x))\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3.03716 -0.52316  0.05063  0.56108  2.59927 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.68200    0.27392  13.442  < 2e-16 ***\nI(x^2)       0.30272    0.03408   8.884 3.44e-14 ***\nlog(x)       2.25320    0.54530   4.132 7.63e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9297 on 97 degrees of freedom\nMultiple R-squared:  0.9246,\tAdjusted R-squared:  0.9231 \nF-statistic: 594.8 on 2 and 97 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n8. Generate some data using this model:\n\n$$ Y \\sim \\mathcal{B}(p),$$\n\nwhere\n\n$$p = xz + \\epsilon,$$\n\nwith $\\epsilon = \\mathcal{N}(0, 0.05)$. Generate $X \\sim \\mathcal{U}(0, 1)$ and $Z \\sim \\mathcal{U}(0, 1)$. Plot the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nn <- 100\nx <- rbeta(n, 2, 1)\nz <- rbeta(n, 1, 2)\n\ny <- rbinom(100, 1, x * z)\n\nplot(x, y)\n```\n\n::: {.cell-output-display}\n![](week-8_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(z, y)\n```\n\n::: {.cell-output-display}\n![](week-8_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "week-8_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}