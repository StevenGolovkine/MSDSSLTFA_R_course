{
  "hash": "2125e789da8673553400dc30c0864db3",
  "result": {
    "markdown": "<!--\n################################################################################\n# Possible solution for week 6 lab - Interactivity\n################################################################################\n# Uncomment the file to make it work.\n-->\n\n<!-- ---\ntitle: \"Our World in Data\"\noutput:\n    flexdashboard::flex_dashboard:\n        theme: \n            version: 4\n            bootswatch: pulse\n            base_font: \n                google: Source Code Pro\n        orientation: columns\nruntime: shiny\n--- -->\n\n\n\n\n\nThe complete Energy dataset is a collection of key metrics maintained by Our World in Data. It is updated regularly and includes data on energy consumption (primary energy, per capita, and growth rates), energy mix, electricity mix and other relevant metrics.\n\nThis data has been collected, aggregated, and documented by Hannah Ritchie, Pablo Rosado, Edouard Mathieu, Max Roser.\n\n[Our World in Data](https://ourworldindata.org/about) makes data and research on the world's largest problems understandable and accessible.\n\n# General \n\nColumn {data-width=650}\n-----------------------------------------------------------------------\n\n### Relationship between population and GDP\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# temp <- df |> \n#     filter(country != 'World') |> \n#     filter(!is.na(population), !is.na(gdp)) |> \n#     select(country, year, population, gdp) |> \n#     mutate(population = population / 1e6) |> \n#     mutate(gdp = gdp / 1e9)\n\n# fig <- temp |> \n#     plot_ly(\n#         x = ~population, \n#         y = ~gdp, \n#         frame = ~year, \n#         text = ~country, \n#         hoverinfo = \"text\",\n#         type = 'scatter',\n#         mode = 'markers'\n#     ) |> \n#     layout(\n#         xaxis = list(title = 'Population (in millions)', type = \"log\"),\n#         yaxis = list(title = 'GDP (in billions)', type = \"log\"),\n#         showlegend = FALSE\n#     ) |> \n#     animation_opts(\n#         1000, easing = \"elastic\", redraw = FALSE\n#   )\n\n# fig\n```\n:::\n\n\nColumn {data-width=350}\n-----------------------------------------------------------------------\n\n### Evolution of the population\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# fillCol(\n#     height = 600,\n#     flex = c(NA, 1), \n#     selectInput(\n#         inputId = \"country\",\n#         label = \"Which country:\",\n#         choices = unique(df$country),\n#         selected = \"Ireland\" \n#     ),\n#     plotOutput(\"population_plot\", height = \"100%\")\n# )\n\n# output$population_plot <- renderPlot({\n#     temp <- df |> \n#         filter(country == input$country) |> \n#         select(year, population) |> \n#         mutate(population = population / 1e6)\n#     ggplot(temp) +\n#         geom_line(aes(x = year, y = population)) +\n#         xlab(\"\") +\n#         ylab(\"Population (in millions)\") +\n#         theme_bw()\n# })\n```\n:::\n\n\n### Population and GDP for the world\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# temp <- df |> \n#     filter(country == 'World') |> \n#     filter(!is.na(population), !is.na(gdp)) |> \n#     select(country, year, population, gdp) |> \n#     mutate(population = population / 1e6) |> \n#     mutate(gdp = gdp / 1e9) |> \n#     accumulate_by(~year)\n\n# temp %>%\n#     plot_ly(\n#         x = ~population, \n#         y = ~gdp, \n#         frame = ~frame, \n#         text = ~year, \n#         hoverinfo = \"text\",\n#         type = 'scatter',\n#         mode = 'lines+markers'\n#     ) |> \n#     layout(\n#         xaxis = list(title = 'Population (in millions)', type = \"log\"),\n#         yaxis = list(title = 'GDP (in billions)', type = \"log\"),\n#         showlegend = FALSE\n#     ) |> \n#     animation_opts(\n#         frame = 100, \n#         transition = 0, \n#         redraw = TRUE\n#     )\n```\n:::\n\n\n# Some statistics\n\nColumn {data-width=650}\n-----------------------------------------------------------------------\n\n### Ratio betwen the demand in electricity and its generation in terawatt-hours in 2018\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# new_df <- df |>\n#     filter(year == 2018) |> \n#     mutate(ratio_electricity = electricity_demand / electricity_generation)\n\n# world@data <- world@data |> \n#     left_join(new_df, by = join_by(\"ADMIN\" == \"country\"))\n\n# pal <- colorNumeric(\"Reds\", NULL, na.color = '#CCCCCC')\n\n# leaflet(world) |> \n#     addTiles() |> \n#     addPolygons(\n#         stroke = TRUE,\n#         color = '#000000',\n#         weight = 1,\n#         smoothFactor = 0.3,\n#         fillOpacity = 1,\n#         fillColor = ~pal(log(ratio_electricity)),\n#         label = ~paste0(\n#             ADMIN, \"\\n \",\n#             \"\\tDemand:\", formatC(electricity_demand, big.mark = \",\"),\n#             \"\\tGeneration:\", formatC(electricity_generation, big.mark = \",\")\n#         )\n#     ) |> \n#     addLegend(\n#         \"bottomleft\",\n#         pal = pal,\n#         values = ~ratio_electricity,\n#         opacity = 1.0,\n#         title = \"Electricity (2018)\"\n#     ) |> \n#     htmlwidgets::prependContent(html_fix)       \n```\n:::\n\n\nColumn {data-width=350}\n-----------------------------------------------------------------------\n\n### Comparison between renewable and fossil electricity produced\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# fillCol(\n#     height = 600,\n#     flex = c(NA, 1), \n#     selectInput(\n#         inputId = \"year\",\n#         label = \"Which year:\",\n#         choices = unique(df$year),\n#         selected = \"2018\" \n#     ),\n#     plotOutput(\"electricity_plot\", height = \"100%\")\n# )\n\n# output$electricity_plot <- renderPlot({\n#     temp <- df |>\n#         filter(year == input$year) |> \n#         select(\n#             country, fossil_electricity, renewables_electricity\n#         ) |> \n#         filter(\n#             !is.na(fossil_electricity), !is.na(renewables_electricity)\n#         ) |> \n#         mutate(\n#             ratio = renewables_electricity / fossil_electricity\n#         )\n#     ggplot(temp) +\n#         geom_violin(aes(x = ratio, y = 0)) +\n#         ggtitle(paste(\"Year:\", input$year)) +\n#         xlim(c(0, 10)) +\n#         xlab(\"Ratio between renewable and fossil electricity\") +\n#         theme_bw() +\n#         theme(\n#             axis.title.y = element_blank(),\n#             axis.ticks.y = element_blank(),\n#             axis.text.y = element_blank()\n#         )\n# })\n```\n:::\n\n\n### Information\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# fillCol(\n#     height = 600,\n#     flex = c(NA, 1), \n#     selectInput(\n#         inputId = \"country\",\n#         label = \"Which country:\",\n#         choices = unique(df$country),\n#         selected = \"Ireland\" \n#     ),\n#     tableOutput(\"information_table\")\n# )\n\n# output$information_table <- renderTable({\n#     temp <- df |>\n#         filter(country == input$country)\n#     temp\n# })\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}